<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>damaris</title>
    <!-- Kept tailwind for utility, though your custom CSS does most work -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* --- GLOBAL SETTINGS --- */
        html { width: 100%; height: 100%; background-color: #000; overflow-x: hidden; }
        body { margin: 0; padding: 0; width: 100%; height: 100%; background-color: #000; color: #fff; overflow: hidden; overflow-x: hidden; font-family: 'Courier New', Courier, monospace; font-weight: bold; font-size: 11pt; -webkit-font-smoothing: none; transition: background-color 0.5s ease; }

        a { color: #fff; text-decoration: none; cursor: pointer; }
        a:hover, a.active { 
            text-decoration: none; 
            background-color: #fff; 
            color: #000; 
        }

        /* --- MOBILE ERROR OVERLAY --- */
        #mobile-error { 
            display: none; 
            position: fixed; 
            top: 0; left: 0; 
            width: 100%; height: 100%; 
            background-color: #000; 
            z-index: 9999; 
            flex-direction: column; 
            justify-content: flex-end; 
            align-items: center; 
            text-align: center;
            padding-bottom: 30px; 
            box-sizing: border-box;
        }
        #punc-error-left { width: 14ch; display: inline-block; }
        #punc-error-right { width: 13ch; display: inline-block; }

        @media (max-width: 1024px) {
            #mobile-error { display: flex; }
            #desktop-content-wrapper { display: none !important; }
            body { overflow: hidden !important; } 
        }

        /* --- NAVIGATION --- */
        #nav-container { position: fixed; bottom: 30px; left: 0; width: 100%; text-align: center; z-index: 100; padding: 0 20px; box-sizing: border-box; user-select: none; overflow: hidden; white-space: nowrap; }
        .nav-text { display: inline-block; white-space: nowrap; }
        
        #punc-1 { width: 14ch; display: inline-block; } 
        #punc-2 { width: 13ch; display: inline-block; } 
        #punc-3 { width: 17ch; display: inline-block; } 
        #punc-4 { width: 13ch; display: inline-block; } 
        
        .link-fixed-width { display: inline-block; width: 75px; text-align: center; }
        .nav-link { display: inline-block; padding: 0 2px; width: 100%; text-align: center; box-sizing: border-box; transition: background-color 0.3s ease, color 0.3s ease; }

        /* --- SECTIONS (PAGES) --- */
        .page-section { 
            display: none; 
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            overflow-y: auto; 
            overflow-x: hidden; 
            overscroll-behavior-x: none; 
            background-color: #000; 
            padding: 80px 0 100px 0; 
            box-sizing: border-box; 
            z-index: 10; 
            animation: fadeIn 0.4s ease-out forwards; 
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        #landing-video {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover; 
            z-index: 0;
        }

        #landing .grid-12 {
            position: relative;
            z-index: 1;
        }

        /* --- GRID SYSTEMS --- */
        .grid-12 { display: grid; grid-template-columns: repeat(12, 1fr); gap: 20px; max-width: none; margin: 0; align-items: start; }
        .project-content-wrapper { padding: 20px 36px 150px 36px; width: 100%; margin: 0; box-sizing: border-box; }
        
        /* --- SLIDESHOW (From Project Pages) --- */
        .slideshow-container { display: flex; overflow-x: auto; gap: 5px; width: 100%; height: 60vh; margin-bottom: 0; padding-left: 0; padding-right: 0; box-sizing: border-box; scrollbar-width: none; -ms-overflow-style: none; scroll-behavior: auto; }
        .slideshow-container::-webkit-scrollbar { display: none; }
        .slide { flex: 0 0 auto; height: 100%; width: auto; position: relative; }
        .slide img, .slide video { height: 100%; width: auto; object-fit: contain; display: block; }

        /* --- ARCHIVE LAYOUT --- */
        .archive-free-layout {
            position: relative; 
            width: 100%;
            min-height: 5000px; 
            max-width: 100%; 
            margin: 0 auto;
        }

        a.project-item { 
            display: flex; 
            flex-direction: column; 
            gap: 10px; 
            background: transparent; 
            /* DEBUGGING: Uncomment the line below to see the red boxes around your projects! */
            /* border: 1px solid red; */ 
            border: none; 
            cursor: grab;
            text-decoration: none; 
            color: #fff; 
            position: absolute; 
            z-index: 1;
            
            /* Positioning logic handled by CSS variables */
            top: var(--top, auto);
            left: var(--left, auto);
            right: var(--right, auto);
            
            /* SIZE CONTROLS: Now you can set --width and --height inline on HTML elements */
            width: var(--width, auto);
            height: var(--height, auto); 
            
            /* Ensure the content inside aligns correctly if box is bigger than image */
            justify-content: center; 
            
            user-select: none;
            -webkit-user-drag: none;
        }
        
        a.project-item.dragging {
            cursor: grabbing;
            z-index: 1000 !important;
            transition: none !important; 
        }
        
        a.project-item:hover { z-index: 50; text-shadow: none; background: transparent; } 

        /* MANUAL POSITIONING DEFAULTS */
        /* You can override --width and --height in the HTML style attribute for specific tweaks */
        .archive-slot-1 { --top: 0px; --right: 0px; --width: 30%; z-index: 3; text-align: right; align-items: flex-end; }
        .archive-slot-3 { --top: 700px; --left: 20px; --width: 60%; z-index: 8; }
        .archive-slot-4 { --top: 1000px; --left: -40px; --width: 70%; z-index: 5; text-align: left; align-items: flex-end; }
        .archive-slot-6 { --top: 1700px; --right: 0px; --width: 100%; z-index: 7; text-align: right; align-items: flex-end; }
        .archive-slot-9 { --top: 2300px; --right: 200px; --width: 50%; z-index: 6; }
        .archive-slot-7 { --top: 2350px; --left: 0px; --width: 100%; z-index: 2; }
        .archive-slot-2 { --top: 3100px; --left: 50px; --width: 100%; z-index: 10; }
        .archive-slot-5 { --top: 3600px; --right: 50px; --width: 100%; z-index: 4; }
        .archive-slot-10 { --top: 4450px; --left: 200px; --width: 80%; z-index: 1; }
        .archive-slot-8 { --top: 4000px; --left: 100px; --width: 40%; z-index: 9; }

        .project-img, .project-video { height: auto; display: block; border: none; pointer-events: none; }
        .project-description { line-height: 1.2; grid-column: 1 / 10; }
        .col-span-12 { grid-column: span 12; }
        
        @media (max-width: 768px) {
            .grid-12 { grid-template-columns: repeat(4, 1fr); }
            .col-span-12 { grid-column: span 4 !important; }
            .project-description { grid-column: 1 / -1 !important; }
            .slideshow-container { height: 50vh; }
            .archive-free-layout { min-height: auto; padding: 0 36px; }
            .archive-free-layout a.project-item {
                position: static !important;
                width: 100% !important;
                margin-bottom: 40px;
                text-align: left !important;
                align-items: flex-start !important;
                cursor: pointer; 
                height: auto !important; /* Reset height on mobile for flow */
            }
        }

        #desktop-content-wrapper { display: none; width: 100%; height: 100%; }
        @media (min-width: 1025px) {
            #desktop-content-wrapper { display: block !important; } 
        }

        /* NEW HOVER BEHAVIOR FOR ARCHIVE IMAGES */
        .project-img {
            transition: transform 0.6s cubic-bezier(0.25, 1, 0.5, 1);
        }

        .project-item:hover .project-img {
            transform: scale(1.04);
        }
        
        /* Disable hover scale while dragging to prevent jitter */
        .project-item.dragging .project-img {
            transform: scale(1.04); 
        }
    </style>
</head>
<body>

<div id="mobile-error">
    <div class="nav-text">
        <span id="punc-error-left">//////////// , </span>
        <span style="padding: 0 10px;">only open on desktop</span>
        <span id="punc-error-right"> / /. . . , / </span>
    </div>
</div>

<div id="desktop-content-wrapper">

    <div id="nav-container">
        <div class="nav-text">
            <span id="punc-1">//////////// , </span>
            <span class="link-fixed-width">
                <a id="link-landing" class="nav-link" href="#landing" 
                   onclick="showSection('landing')"
                   onmouseover="startHoverAnimation('punc-1', 'punc-2')" 
                   onmouseout="stopHoverAnimation('punc-1', 'punc-2')">start</a>
            </span>
            <span id="punc-2"> / /. . . , / </span>
            <span class="link-fixed-width">
                <a id="link-archive" class="nav-link" href="#archive" 
                   onclick="showSection('archive')"
                   onmouseover="startHoverAnimation('punc-2', 'punc-3')" 
                   onmouseout="stopHoverAnimation('punc-2', 'punc-3')">archive</a>
            </span>
            <span id="punc-3"> ,,. /////.,:;:* </span>
            <span class="link-fixed-width">
                <a id="link-profile" class="nav-link" href="profile.html" 
                   onmouseover="startHoverAnimation('punc-3', 'punc-4')" 
                   onmouseout="stopHoverAnimation('punc-3', 'punc-4')">profile</a>
            </span>
            <span id="punc-4">. ../-.-_.-.--</span>
        </div>
    </div>
    
    <div id="landing" class="page-section" style="display: block;">
        <video autoplay loop muted playsinline id="landing-video">
             <source src="video/startvideo.mp4" type="video/mp4">
        </video>
        <div class="grid-12" style="padding: 0 36px;">
            <h1 class="col-span-12" style="margin-top: 10vh;"><br></h1>
        </div>
    </div>

    <div id="archive" class="page-section">
        <div id="archive-content-wrapper" class="archive-free-layout">
            <!-- 
               HOW TO CUSTOMIZE HIT AREAS:
               Change --width and --height in the style="" attribute for each project below.
               'auto' means it fits the image size.
               '500px' or '100%' forces a specific size box for clicking/dragging.
            -->
            
            <!-- Sketchbooks (Default CSS width: 50%) -->
            <a href="notebooks.html" class="project-item archive-slot-1" style="--width: 50%; --height: auto;">
                <img class="project-img" style="width: 75%;" src="bilder/skizzenbuecher/cover.webp" alt="skizzenbuecher">
            </a>
            
            <!-- Photography (Default CSS width: 100%) -->
            <a href="photography.html" class="project-item archive-slot-2" style="--width: 100%; --height: auto;">
                <img class="project-img" style="width: 50%;" src="bilder/fotografie/cover.webp" alt="photography">
            </a>
            
            <!-- Design Classics (Default CSS width: 60%) -->
            <a href="designclassics.html" class="project-item archive-slot-3" style="--width: 60%; --height: auto;">
                <img class="project-img" style="width: 100%;" src="bilder/designobjektekatalog/cover.webp" alt="designclassics">
            </a>

            <!-- Paris (Default CSS width: 70%) -->
            <a href="paris.html" class="project-item archive-slot-4" style="--width: 70%; --height: auto;">
                <img class="project-img" style="width: 100%;" src="bilder/parisprojekt/cover.webp" alt="paris">
            </a>

            <!-- Memory (Default CSS width: 100%) -->
            <a href="erinnerung.html" class="project-item archive-slot-5" style="--width: 100%; --height: auto;">
                <img class="project-img" style="width: 80%;" src="bilder/blickwechsel/cover.webp" alt="erinnerung">
            </a>

            <!-- Kyoto (Default CSS width: 100%) -->
            <a href="kyoto.html" class="project-item archive-slot-6" style="--width: 100%; --height: auto;">
                <img class="project-img" style="width: 50%;" src="bilder/bildmarke/cover.webp" alt="kyoto">
            </a>

            <!-- London (Default CSS width: 100%) -->
            <a href="london.html" class="project-item archive-slot-7" style="--width: 100%; --height: auto;">
                <img class="project-img" style="width: 100%;" src="bilder/londonprojekt/cover.webp" alt="london">
            </a>

            <!-- Shades (Default CSS width: 50%) -->
            <a href="shades.html" class="project-item archive-slot-9" style="--width: 50%; --height: auto;">
                <img class="project-img" style="width: 100%;" src="bilder/londonbildmaterial/cover.webp" alt="shades">
            </a>

            <!-- Squares (Default CSS width: 80%) -->
            <a href="squares.html" class="project-item archive-slot-10" style="--width: 80%; --height: auto;">
                <img class="project-img" style="width: 50%;" src="bilder/quadrate/cover.webp" alt="squares">
            </a>
        </div>
    </div>

</div>

<script>
    const FORCE_DESKTOP_PREVIEW = true; 
    const IS_DESKTOP = FORCE_DESKTOP_PREVIEW || window.innerWidth >= 1025;
    
    // --- PUNCTUATION ANIMATION ---
    const PUNCTUATION_FINAL = { 
        'punc-1': '//////////// , ', 
        'punc-2': ' / /. . . , / ', 
        'punc-3': ' ,,. /////.,:;:* ', 
        'punc-4': '. ../-.-_.-.--',
        'punc-error-left': '//////////// , ',
        'punc-error-right': ' / /. . . , / '
    };
    const PUNCTUATION_POOL = ['/', ',', '.', ':', ';', '*', '-', '_', '|', '+', '(', ')', '[', ']', '<', '>', ' '];
    const activeIntervals = {};
    let isLoadAnimating = true;

    function generateRandomPunctuation(length) {
        let result = '';
        for (let i = 0; i < length; i++) {
            result += PUNCTUATION_POOL[Math.floor(Math.random() * PUNCTUATION_POOL.length)];
        }
        return result;
    }

    function animateSpecificPunctuation(puncId) {
        const element = document.getElementById(puncId);
        if (element) {
            element.textContent = generateRandomPunctuation(PUNCTUATION_FINAL[puncId].length);
        }
    }

    function startPunctuationAnimation() {
        let loadInterval = setInterval(() => {
            for (const id in PUNCTUATION_FINAL) {
                if (id.startsWith('punc-') && !id.includes('error')) {
                    animateSpecificPunctuation(id);
                }
            }
        }, 50);

        setTimeout(() => {
            clearInterval(loadInterval); 
            isLoadAnimating = false;    
            for (const id in PUNCTUATION_FINAL) {
                const el = document.getElementById(id);
                if (el && !id.includes('error')) el.textContent = PUNCTUATION_FINAL[id];
            }
        }, 5000); 
    }

    function startHoverAnimation(puncId1, puncId2) {
        if (isLoadAnimating) return; 
        if (!activeIntervals[puncId1]) {
            animateSpecificPunctuation(puncId1);
            activeIntervals[puncId1] = setInterval(() => animateSpecificPunctuation(puncId1), 50);
        }
        if (!activeIntervals[puncId2]) {
            animateSpecificPunctuation(puncId2);
            activeIntervals[puncId2] = setInterval(() => animateSpecificPunctuation(puncId2), 50);
        }
    }

    function stopHoverAnimation(puncId1, puncId2) {
        if (activeIntervals[puncId1]) {
            clearInterval(activeIntervals[puncId1]);
            delete activeIntervals[puncId1];
            const el1 = document.getElementById(puncId1);
            if (el1) el1.textContent = PUNCTUATION_FINAL[puncId1];
        }
        if (activeIntervals[puncId2]) {
            clearInterval(activeIntervals[puncId2]);
            delete activeIntervals[puncId2];
            const el2 = document.getElementById(puncId2);
            if (el2) el2.textContent = PUNCTUATION_FINAL[puncId2];
        }
    }

    // --- DRAGGABLE FUNCTIONALITY ---
    function initDraggable() {
        if (!IS_DESKTOP) return; 

        const items = document.querySelectorAll('.project-item');
        let dragItem = null;
        let dragOffsetX = 0;
        let dragOffsetY = 0;
        let startX = 0;
        let startY = 0;
        let isDragging = false;

        items.forEach(item => {
            // Mouse events
            item.addEventListener('mousedown', dragStart);
            
            // Prevent default click if it was a drag
            item.addEventListener('click', function(e) {
                if (isDragging) {
                    e.preventDefault();
                    e.stopPropagation();
                } else {
                    // It's a valid click, save scroll position before navigating
                    saveArchiveScroll();
                }
            });
            
            // Touch events
            item.addEventListener('touchstart', dragStart, {passive: false});
        });

        function dragStart(e) {
            if (window.innerWidth <= 768) return;
            if (e.type === 'mousedown' && e.button !== 0) return;

            dragItem = this;
            const rect = dragItem.getBoundingClientRect();
            
            const clientX = e.type.includes('touch') ? e.touches[0].clientX : e.clientX;
            const clientY = e.type.includes('touch') ? e.touches[0].clientY : e.clientY;

            // FREEZE POSITION: Convert CSS variable positioning to absolute pixel values
            // offsetLeft gets the pixel distance from the parent, handling right/left CSS vars correctly
            const currentLeft = dragItem.offsetLeft;
            const currentTop = dragItem.offsetTop;

            // Apply explicit pixel styles. This prevents the element from jumping
            // when we unset 'right' or 'bottom' in the next step.
            dragItem.style.left = currentLeft + 'px';
            dragItem.style.top = currentTop + 'px';
            dragItem.style.right = 'auto'; // Disable CSS variable 'right' positioning
            dragItem.style.bottom = 'auto';
            dragItem.style.width = getComputedStyle(dragItem).width; // Freeze width
            dragItem.style.height = getComputedStyle(dragItem).height; // Freeze height as well

            // Calculate where the mouse is relative to the element's top-left corner
            dragOffsetX = clientX - rect.left;
            dragOffsetY = clientY - rect.top;
            
            startX = clientX;
            startY = clientY;
            isDragging = false; 

            dragItem.classList.add('dragging');

            if (e.type === 'mousedown') {
                document.addEventListener('mousemove', dragMove);
                document.addEventListener('mouseup', dragEnd);
            } else {
                document.addEventListener('touchmove', dragMove, {passive: false});
                document.addEventListener('touchend', dragEnd);
            }
        }

        function dragMove(e) {
            if (!dragItem) return;

            const clientX = e.type.includes('touch') ? e.touches[0].clientX : e.clientX;
            const clientY = e.type.includes('touch') ? e.touches[0].clientY : e.clientY;

            const dist = Math.hypot(clientX - startX, clientY - startY);
            if (dist > 5) {
                isDragging = true;
            }

            if (e.type === 'touchmove') e.preventDefault(); 

            const parentRect = dragItem.parentElement.getBoundingClientRect();
            
            // Calculate new position relative to parent container
            const newLeft = clientX - parentRect.left - dragOffsetX;
            const newTop = clientY - parentRect.top - dragOffsetY;

            dragItem.style.left = newLeft + 'px';
            dragItem.style.top = newTop + 'px';
        }

        function dragEnd(e) {
            if (dragItem) {
                dragItem.classList.remove('dragging');
                dragItem = null;
            }
            document.removeEventListener('mousemove', dragMove);
            document.removeEventListener('mouseup', dragEnd);
            document.removeEventListener('touchmove', dragMove);
            document.removeEventListener('touchend', dragEnd);
            
            setTimeout(() => { isDragging = false; }, 50);
        }
    }

    // --- SCROLL PRESERVATION LOGIC ---
    let savedArchiveScroll = 0;

    function saveArchiveScroll() {
        const archiveEl = document.getElementById('archive');
        if (archiveEl) {
            savedArchiveScroll = archiveEl.scrollTop;
            sessionStorage.setItem('archiveScrollPos', savedArchiveScroll);
        }
    }

    function restoreArchiveScroll() {
        const archiveEl = document.getElementById('archive');
        if (archiveEl) {
            let pos = savedArchiveScroll;
            if (pos === 0) {
                const stored = sessionStorage.getItem('archiveScrollPos');
                if (stored) pos = parseInt(stored, 10);
            }
            setTimeout(() => {
                archiveEl.scrollTop = pos;
            }, 0);
        }
    }

    // --- INITIALIZATION ---
    window.addEventListener('load', function() {
        const storedScroll = sessionStorage.getItem('archiveScrollPos');
        if (storedScroll) {
            savedArchiveScroll = parseInt(storedScroll, 10);
        }

        const isDesktop = FORCE_DESKTOP_PREVIEW || window.innerWidth >= 1025;

        if (isDesktop) {
            startPunctuationAnimation();
            initDraggable();
            
            let sectionToShow = 'landing'; 
            
            const hash = window.location.hash.substring(1); 
            if (hash && document.getElementById(hash)) {
                sectionToShow = hash;
            } else if (storedScroll && storedScroll > 0) {
                // If returning with scroll data, assume archive
                sectionToShow = 'archive';
            }
            
            showSection(sectionToShow);
            
        } else {
            setInterval(() => {
                animateSpecificPunctuation('punc-error-left');
                animateSpecificPunctuation('punc-error-right');
            }, 50);
        }
    });

    function showSection(sectionId) {
        const archiveSection = document.getElementById('archive');
        if (archiveSection.style.display === 'block') {
            saveArchiveScroll();
        }

        document.querySelectorAll('.page-section').forEach(p => p.style.display = 'none');
        
        const targetSection = document.getElementById(sectionId);
        if (targetSection) {
            targetSection.style.display = 'block';
            
            if (sectionId === 'archive') {
                restoreArchiveScroll();
            }
        }
        
        document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
        const activeLink = document.getElementById('link-' + sectionId);
        if (activeLink) activeLink.classList.add('active');
    }
</script>
</body>
</html>